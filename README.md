# Railway Deployment Guide для Telegram Music Bot

## Шаг 1: Подготовка файлов

Создайте папку для проекта и добавьте следующие файлы:

1. `main.go` - основной код бота (обновленная версия)
2. `go.mod` - зависимости Go
3. `go.sum` - checksums зависимостей
4. `Dockerfile` - для контейнеризации
5. `railway.toml` - конфигурация Railway

## Шаг 2: Создание Telegram бота

1. Перейдите к [@BotFather](https://t.me/botfather) в Telegram
2. Создайте нового бота командой `/newbot`
3. Следуйте инструкциям и получите BOT_TOKEN
4. Сохраните токен - он понадобится для Railway

## Шаг 3: Создание канала для кеширования

1. Создайте приватный канал в Telegram
2. Добавьте вашего бота как администратора канала
3. Получите ID канала (начинается с -100)
4. Это будет ваш CACHE_CHANNEL_ID

## Шаг 4: Получение Admin ID

1. Напишите боту [@userinfobot](https://t.me/userinfobot)
2. Получите ваш user ID
3. Это будет ваш ADMIN_ID

## Шаг 5: Деплой на Railway

### Вариант 1: Через GitHub (рекомендуется)

1. Создайте новый репозиторий на GitHub
2. Загрузите все файлы в репозиторий
3. Перейдите на [railway.app](https://railway.app)
4. Войдите через GitHub
5. Нажмите "New Project" → "Deploy from GitHub repo"
6. Выберите ваш репозиторий

### Вариант 2: Через Railway CLI

```bash
# Установите Railway CLI
npm install -g @railway/cli

# Войдите в аккаунт
railway login

# Инициализируйте проект
railway init

# Деплой
railway up
```

## Шаг 6: Настройка переменных окружения

В панели Railway добавьте следующие переменные:

```
BOT_TOKEN=your_bot_token_here
ADMIN_ID=your_admin_id_here
CACHE_CHANNEL_ID=your_cache_channel_id_here
```

### Как добавить переменные в Railway:

1. Откройте ваш проект в Railway
2. Перейдите в "Variables" tab
3. Нажмите "New Variable"
4. Добавьте каждую переменную:
   - Name: `BOT_TOKEN`, Value: ваш токен бота
   - Name: `ADMIN_ID`, Value: ваш ID администратора
   - Name: `CACHE_CHANNEL_ID`, Value: ID канала для кеша

## Шаг 7: Проверка деплоя

1. Дождитесь завершения деплоя
2. Проверьте логи в Railway Dashboard
3. Найдите вашего бота в Telegram
4. Отправьте команду `/start`

## Возможные проблемы и решения

### Проблема: Bot не отвечает
**Решение**: Проверьте логи в Railway Dashboard, убедитесь что все переменные окружения установлены правильно.

### Проблема: Ошибка при скачивании
**Решение**: yt-dlp может быть заблокирован. Попробуйте перезапустить деплой.

### Проблема: Превышение лимитов Railway
**Решение**: Railway имеет лимиты для бесплатного тарифа. Рассмотрите upgrade на платный план.

## Полезные команды Railway CLI

```bash
# Просмотр логов
railway logs

# Перезапуск сервиса
railway restart

# Просмотр переменных
railway variables

# Подключение к базе данных (если нужно)
railway connect
```

## Структура проекта

```
telegram-music-bot/
├── main.go           # Основной код бота
├── go.mod           # Go модули
├── go.sum           # Checksums
├── Dockerfile       # Docker конфигурация
├── railway.toml     # Railway конфигурация
└── README.md        # Этот файл
```

## Дополнительные настройки

### Добавление домена (опционально)

1. В Railway Dashboard перейдите в "Settings"
2. В разделе "Domains" добавьте свой домен
3. Настройте DNS записи согласно инструкции

### Мониторинг и логи

1. Используйте Railway Dashboard для просмотра метрик
2. Настройте уведомления о сбоях
3. Регулярно проверяйте логи на ошибки

## Безопасность

⚠️ **ВАЖНО**: Никогда не коммитьте токены и секретные ключи в репозиторий! Используйте переменные окружения.

## Обновление бота

1. Внесите изменения в код
2. Закоммитьте в GitHub (если используете GitHub деплой)
3. Railway автоматически пересоберет и перезапустит бот

## Лимиты Railway (бесплатный план)

- 500 часов в месяц
- 1GB RAM
- 1GB дискового пространства
- Автоматический сон после 30 минут неактивности

## Контакты и поддержка

Если возникли проблемы:
1. Проверьте логи в Railway Dashboard
2. Убедитесь что все переменные окружения установлены
3. Проверьте права бота в Telegram канале
4. Обратитесь к документации Railway: https://docs.railway.app
